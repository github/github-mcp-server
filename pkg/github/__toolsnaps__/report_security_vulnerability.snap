{
  "annotations": {
    "title": "Report security vulnerability"
  },
  "description": "Report a security vulnerability to the maintainers of a repository. Creates a private security advisory in 'triage' state.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "cvss_vector_string": {
        "type": "string",
        "description": "The CVSS vector that calculates the severity of the advisory. You must choose between setting this field or severity."
      },
      "cwe_ids": {
        "type": "array",
        "items": {
          "type": "string"
        },
        "description": "A list of Common Weakness Enumeration (CWE) IDs (e.g. [\"CWE-79\", \"CWE-89\"])."
      },
      "description": {
        "type": "string",
        "description": "A detailed description of what the vulnerability entails."
      },
      "owner": {
        "type": "string",
        "description": "The owner of the repository."
      },
      "repo": {
        "type": "string",
        "description": "The name of the repository."
      },
      "severity": {
        "type": "string",
        "description": "The severity of the advisory. You must choose between setting this field or cvss_vector_string.",
        "enum": [
          "critical",
          "high",
          "medium",
          "low"
        ]
      },
      "start_private_fork": {
        "type": "boolean",
        "description": "Whether to create a temporary private fork of the repository to collaborate on a fix. Default: false",
        "default": false
      },
      "summary": {
        "type": "string",
        "description": "A short summary of the security vulnerability."
      },
      "vulnerabilities": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "package": {
              "type": "object",
              "properties": {
                "ecosystem": {
                  "type": "string",
                  "description": "The package ecosystem (e.g., npm, pip, maven, rubygems)."
                },
                "name": {
                  "type": "string",
                  "description": "The package name."
                }
              },
              "description": "The package affected by the vulnerability.",
              "required": [
                "ecosystem",
                "name"
              ]
            },
            "patched_versions": {
              "type": "string",
              "description": "The versions that patch the vulnerability (e.g., '1.0.1')."
            },
            "vulnerable_functions": {
              "type": "array",
              "items": {
                "type": "string"
              },
              "description": "The names of vulnerable functions in the package."
            },
            "vulnerable_version_range": {
              "type": "string",
              "description": "The range of versions that are vulnerable (e.g., '\u003e= 1.0.0, \u003c 1.0.1')."
            }
          },
          "required": [
            "package"
          ]
        },
        "description": "An array of products affected by the vulnerability."
      }
    },
    "required": [
      "owner",
      "repo",
      "summary",
      "description"
    ]
  },
  "name": "report_security_vulnerability"
}