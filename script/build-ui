#!/bin/bash
# Build the MCP App UIs
set -e

cd "$(dirname "$0")/../ui"

# Install dependencies if needed
if [ ! -d "node_modules" ]; then
  echo "Installing UI dependencies..."
  npm install
fi

echo "Building UI..."
npm run build

# Move files to expected locations
echo "Organizing output..."
mkdir -p dist
mv dist/src/apps/get-me/index.html dist/get-me.html 2>/dev/null || true
mv dist/src/apps/create-issue/index.html dist/create-issue.html 2>/dev/null || true
rm -rf dist/src 2>/dev/null || true

# Copy to Go embed location
echo "Copying to pkg/github/ui_dist/..."
mkdir -p ../pkg/github/ui_dist
cp dist/*.html ../pkg/github/ui_dist/

echo "UI build complete. Output:"
ls -la dist/
